<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Life Tracker</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js (Grafikler i√ßin) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome (ƒ∞konlar i√ßin) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        
        /* Animasyonlar ve Ge√ßi≈üler */
        .card-hover { transition: transform 0.2s, box-shadow 0.2s; }
        .card-hover:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        /* Checkbox Stili */
        .custom-checkbox:checked + label { text-decoration: line-through; color: #9ca3af; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Takvim */
        .calendar-day { aspect-ratio: 1; transition: all 0.2s; }
        .calendar-day:hover { z-index: 10; transform: scale(1.15); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="p-4 md:p-6 lg:p-8 max-w-7xl mx-auto">

    <!-- HEADER & SKORLAR -->
    <header id="main-header" class="relative bg-gradient-to-r from-indigo-600 to-blue-500 rounded-3xl p-6 text-white shadow-xl mb-8 transition-colors duration-500">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl md:text-4xl font-black tracking-tight mb-2">üöÄ Ya≈üam Y√∂netim Merkezi</h1>
                <p class="opacity-80">Geli≈üimini verilerle takip et.</p>
            </div>
            <button onclick="openSettings()" class="p-2 bg-white/20 rounded-full hover:bg-white/30 transition">
                <i class="fa-solid fa-gear text-xl"></i>
            </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
            <!-- G√ºnl√ºk Skor -->
            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 flex items-center justify-between border border-white/10">
                <div>
                    <span class="text-xs uppercase tracking-wider opacity-70">G√ºnl√ºk Verim</span>
                    <div class="text-3xl font-bold"><span id="daily-score">0</span>%</div>
                </div>
                <div class="text-4xl" id="daily-emoji">üòê</div>
            </div>

            <!-- Uyku Kalitesi -->
            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/10">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-xs uppercase tracking-wider opacity-70">Uyku Kalitesi</span>
                    <i class="fa-solid fa-bed opacity-70"></i>
                </div>
                <div class="flex items-center gap-2">
                    <input type="number" id="sleep-input" class="w-16 bg-white/20 border-none rounded px-2 py-1 text-center font-bold text-white placeholder-white/50 focus:ring-2 focus:ring-white" placeholder="Saat">
                    <button onclick="saveSleep()" class="bg-white text-indigo-600 px-3 py-1 rounded font-bold text-sm hover:bg-gray-100">Kaydet</button>
                </div>
            </div>

            <!-- Spor Kalitesi (Volume Load) -->
            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/10">
                <div class="flex justify-between items-center mb-1">
                    <span class="text-xs uppercase tracking-wider opacity-70">Spor Hacmi (Vol)</span>
                    <i class="fa-solid fa-dumbbell opacity-70"></i>
                </div>
                <div class="text-2xl font-bold"><span id="total-volume">0</span> <span class="text-xs font-normal opacity-60">kg</span></div>
                <div class="w-full bg-black/20 h-1.5 rounded-full mt-2">
                    <div id="volume-bar" class="bg-green-400 h-1.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <!-- SOL KOLON: Program & Kitap -->
        <div class="lg:col-span-2 space-y-8">
            
            <!-- G√úNL√úK PROGRAM -->
            <section class="bg-white rounded-3xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                        <i class="fa-regular fa-calendar-check text-indigo-500"></i> G√ºnl√ºk Program
                    </h2>
                    <div class="text-sm text-gray-500 font-mono" id="current-date-display">...</div>
                </div>

                <!-- G√ºn Se√ßici -->
                <div class="flex overflow-x-auto gap-2 pb-4 mb-2" id="day-selector">
                    <!-- JS ile doldurulacak -->
                </div>

                <!-- G√∂rev Listesi -->
                <ul id="task-list" class="space-y-3 min-h-[200px]">
                    <!-- JS ile doldurulacak -->
                </ul>

                <!-- Yeni G√∂rev Ekleme -->
                <div class="mt-6 pt-4 border-t border-gray-100">
                    <div class="flex gap-2">
                        <input type="text" id="new-task-text" placeholder="Yeni g√∂rev ekle..." class="flex-1 border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                        <select id="new-task-type" class="border border-gray-300 rounded-xl px-2 py-2 text-sm text-gray-600 focus:outline-none">
                            <option value="Ders">Ders</option>
                            <option value="Spor">Spor</option>
                            <option value="√áalƒ±≈üma">√áalƒ±≈üma</option>
                            <option value="Ya≈üam">Ya≈üam</option>
                        </select>
                        <button onclick="addNewTask()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-xl transition">
                            <i class="fa-solid fa-plus"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Kƒ∞TAP OKUMA TAKƒ∞Bƒ∞ -->
            <section class="bg-white rounded-3xl shadow-lg p-6 bg-gradient-to-br from-amber-50 to-orange-50">
                <h2 class="text-xl font-bold text-amber-800 mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-book-open"></i> Kitap Okuma Takibi
                </h2>
                <div class="flex items-center gap-4">
                    <div class="flex-1">
                        <label class="block text-sm text-amber-900/70 mb-1">Bug√ºn okunan sayfa sayƒ±sƒ±</label>
                        <div class="flex gap-2">
                            <input type="number" id="reading-input" class="w-full border border-amber-200 rounded-xl px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:outline-none" placeholder="0">
                            <button onclick="saveReading()" class="bg-amber-600 text-white px-6 rounded-xl hover:bg-amber-700 font-bold">Kaydet</button>
                        </div>
                    </div>
                    <div class="text-center p-4 bg-white/50 rounded-xl border border-amber-100">
                        <div class="text-2xl font-bold text-amber-600" id="reading-display">0</div>
                        <div class="text-xs text-amber-800">Sayfa</div>
                    </div>
                </div>
            </section>

        </div>

        <!-- SAƒû KOLON: Spor & Takvim -->
        <div class="space-y-8">

            <!-- GELƒ∞≈ûMƒ∞≈û SPOR MOD√úL√ú -->
            <section class="bg-white rounded-3xl shadow-lg p-6 border-t-4 border-green-500">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-dumbbell text-green-600"></i> Antrenman G√ºnl√ºƒü√º
                </h2>

                <!-- Kas Grubu Se√ßimi -->
                <div class="mb-4">
                    <label class="text-xs font-bold text-gray-500 uppercase">B√∂lge Se√ß</label>
                    <select id="muscle-group" onchange="loadExercises()" class="w-full mt-1 p-2 border rounded-lg bg-gray-50 font-semibold">
                        <option value="">-- Se√ßiniz --</option>
                        <option value="gogus">G√∂ƒü√ºs (Chest)</option>
                        <option value="sirt">Sƒ±rt (Back)</option>
                        <option value="bacak">Bacak (Legs)</option>
                        <option value="omuz">Omuz (Shoulders)</option>
                        <option value="kol">Kol (Arms)</option>
                        <option value="karin">Karƒ±n (Abs)</option>
                        <option value="kardiyo">Kardiyo</option>
                    </select>
                </div>

                <!-- Hareket Se√ßimi -->
                <div class="mb-4">
                    <label class="text-xs font-bold text-gray-500 uppercase">Hareket Se√ß</label>
                    <select id="exercise-select" class="w-full mt-1 p-2 border rounded-lg bg-gray-50">
                        <option value="">√ñnce B√∂lge Se√ßin</option>
                    </select>
                </div>

                <!-- Set/Tekrar/Aƒüƒ±rlƒ±k Giri≈üi -->
                <div class="grid grid-cols-3 gap-2 mb-4">
                    <div>
                        <label class="text-xs text-gray-500">Aƒüƒ±rlƒ±k (kg)</label>
                        <input type="number" id="w-weight" class="w-full p-2 border rounded-lg" placeholder="Kg">
                    </div>
                    <div>
                        <label class="text-xs text-gray-500">Set</label>
                        <input type="number" id="w-sets" class="w-full p-2 border rounded-lg" placeholder="3">
                    </div>
                    <div>
                        <label class="text-xs text-gray-500">Tekrar</label>
                        <input type="number" id="w-reps" class="w-full p-2 border rounded-lg" placeholder="12">
                    </div>
                </div>

                <button onclick="addWorkoutSet()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded-xl mb-6 shadow-md transition transform active:scale-95">
                    Hareketi Ekle
                </button>

                <!-- Eklenen Hareketler Listesi -->
                <div class="bg-gray-50 rounded-xl p-3 mb-6">
                    <h3 class="text-sm font-bold text-gray-600 mb-2 border-b pb-1">Bug√ºn√ºn Antrenmanƒ±</h3>
                    <ul id="workout-list" class="text-sm space-y-2 max-h-40 overflow-y-auto">
                        <li class="text-gray-400 text-center italic text-xs py-2">Hen√ºz hareket girilmedi.</li>
                    </ul>
                </div>

                <!-- Grafik Alanƒ± -->
                <div>
                    <h3 class="text-sm font-bold text-gray-600 mb-2">Haftalƒ±k Volume Load (kg)</h3>
                    <div class="h-48">
                        <canvas id="workoutChart"></canvas>
                    </div>
                    <p class="text-[10px] text-gray-400 mt-1 text-center italic">*Volume Load = Set x Tekrar x Aƒüƒ±rlƒ±k (Hipertrofi G√∂stergesi)</p>
                </div>
            </section>

            <!-- TAKVƒ∞M -->
            <section class="bg-white rounded-3xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">Takvim</h2>
                    <div class="flex gap-2 text-sm text-gray-500">
                        <button onclick="changeMonth(-1)" class="hover:text-indigo-600"><i class="fa-solid fa-chevron-left"></i></button>
                        <span id="calendar-month" class="font-bold w-24 text-center">Kasƒ±m 2024</span>
                        <button onclick="changeMonth(1)" class="hover:text-indigo-600"><i class="fa-solid fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="grid grid-cols-7 gap-1 text-center text-xs font-bold text-gray-400 mb-2">
                    <div>Pzt</div><div>Sal</div><div>√áar</div><div>Per</div><div>Cum</div><div>Cmt</div><div>Paz</div>
                </div>
                <div id="calendar-grid" class="grid grid-cols-7 gap-1">
                    <!-- JS ile doldurulacak -->
                </div>
            </section>

        </div>
    </div>

    <!-- AYARLAR MODALI -->
    <div id="settings-modal" class="fixed inset-0 bg-black/50 hidden flex justify-center items-center z-50 backdrop-blur-sm">
        <div class="bg-white rounded-3xl p-8 w-96 shadow-2xl transform transition-all">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">√ñzelle≈ütirme</h2>
            
            <div class="mb-6">
                <label class="block text-sm font-bold text-gray-600 mb-2">Header Rengi</label>
                <div class="flex gap-3">
                    <button onclick="setTheme('indigo')" class="w-10 h-10 rounded-full bg-indigo-600 ring-2 ring-offset-2 ring-transparent focus:ring-indigo-400"></button>
                    <button onclick="setTheme('red')" class="w-10 h-10 rounded-full bg-red-600 ring-2 ring-offset-2 ring-transparent focus:ring-red-400"></button>
                    <button onclick="setTheme('emerald')" class="w-10 h-10 rounded-full bg-emerald-600 ring-2 ring-offset-2 ring-transparent focus:ring-emerald-400"></button>
                    <button onclick="setTheme('slate')" class="w-10 h-10 rounded-full bg-slate-800 ring-2 ring-offset-2 ring-transparent focus:ring-slate-400"></button>
                </div>
            </div>

            <button onclick="closeSettings()" class="w-full bg-gray-200 text-gray-800 font-bold py-3 rounded-xl hover:bg-gray-300">Kapat</button>
        </div>
    </div>

    <!-- JAVASCRIPT KODLARI -->
    <script>
        // --- VERƒ∞TABANI & AYARLAR ---
        const STORAGE_KEY = 'life_tracker_v3';
        const EXERCISE_DB = {
            'omuz': ['Military Press', 'Lateral Raise', 'Front Raise', 'Face Pull', 'Arnold Press', 'Rear Delt Fly'],
            'gogus': ['Bench Press', 'Incline Dumbbell Press', 'Cable Fly', 'Push Up', 'Dips', 'Chest Press Machine'],
            'sirt': ['Pull Up', 'Lat Pulldown', 'Barbell Row', 'Seated Cable Row', 'Deadlift', 'Single Arm Row'],
            'bacak': ['Squat', 'Leg Press', 'Leg Extension', 'Leg Curl', 'Lunges', 'Calf Raise'],
            'kol': ['Barbell Curl', 'Hammer Curl', 'Tricep Pushdown', 'Skull Crusher', 'Preacher Curl'],
            'karin': ['Plank', 'Crunches', 'Leg Raise', 'Russian Twist', 'Cable Crunch'],
            'kardiyo': ['Ko≈üu Bandƒ± (dk)', 'Bisiklet (dk)', 'Eliptik (dk)', 'Y√ºr√ºy√º≈ü (dk)']
        };

        // Varsayƒ±lan Template (Sadece ilk y√ºklemede kullanƒ±lƒ±r)
        const DEFAULT_TEMPLATE = {
            'Pazartesi': [{text: 'Devre Temelleri', type: 'Ders', done: false}],
            'Salƒ±': [{text: 'Termodinamik', type: 'Ders', done: false}],
            '√áar≈üamba': [{text: 'Veri Bilimi', type: '√áalƒ±≈üma', done: false}],
            'Per≈üembe': [{text: 'Lineer Cebir', type: 'Ders', done: false}],
            'Cuma': [{text: 'Statik & Malzeme', type: 'Ders', done: false}],
            'Cumartesi': [{text: 'Almanca', type: 'Ders', done: false}],
            'Pazar': [{text: 'Haftalƒ±k Planlama', type: 'Ya≈üam', done: false}]
        };

        let appData = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
        let currentViewDate = new Date(); // ≈ûu an g√∂r√ºnt√ºlenen g√ºn
        let currentCalendarDate = new Date(); // Takvimde g√∂r√ºnt√ºlenen ay
        let workoutChartInstance = null;

        // --- YARDIMCI FONKSƒ∞YONLAR ---
        function formatDate(date) { return date.toISOString().split('T')[0]; }
        function getDayName(date) { const days = ['Pazar','Pazartesi','Salƒ±','√áar≈üamba','Per≈üembe','Cuma','Cumartesi']; return days[date.getDay()]; }
        
        function getDailyData(dateStr) {
            if (!appData[dateStr]) {
                const dayName = getDayName(new Date(dateStr));
                // Eƒüer o g√ºn i√ßin veri yoksa, template'den kopyala ama referans baƒüƒ±msƒ±z olsun
                const templateTasks = DEFAULT_TEMPLATE[dayName] ? JSON.parse(JSON.stringify(DEFAULT_TEMPLATE[dayName])) : [];
                
                appData[dateStr] = {
                    tasks: templateTasks,
                    sleep: null,
                    reading: 0,
                    workouts: [], // { muscle, exercise, sets, reps, weight, totalVol }
                    theme: 'indigo'
                };
            }
            return appData[dateStr];
        }

        function saveData() {
            // Son se√ßilen temayƒ± genel ayar olarak da saklayalƒ±m ki sayfa yenilenince hatƒ±rlasƒ±n
            if(!appData.settings) appData.settings = { theme: 'indigo' };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
            updateUI();
        }

        // --- UI G√úNCELLEME ---
        function updateUI() {
            const dateStr = formatDate(currentViewDate);
            const data = getDailyData(dateStr);
            const dayName = getDayName(currentViewDate);

            // Ba≈ülƒ±k Bilgisi
            document.getElementById('current-date-display').innerText = `${dayName}, ${dateStr}`;
            
            // G√ºn Se√ßici (Son 3 g√ºn + Bug√ºn + Gelecek 3 g√ºn)
            renderDaySelector();

            // G√∂rev Listesi
            renderTasks(data.tasks, dateStr);

            // Skorlar
            calculateDailyScore(data);
            
            // Uyku & Kitap
            document.getElementById('sleep-input').value = data.sleep || '';
            document.getElementById('reading-display').innerText = data.reading || 0;
            document.getElementById('reading-input').value = ''; // Inputu temizle

            // Spor Listesi
            renderWorkoutList(data.workouts);
            renderWorkoutChart();

            // Takvim
            renderCalendar();

            // Tema
            applyTheme(appData.settings?.theme || 'indigo');
        }

        // --- G√ñREV Y√ñNETƒ∞Mƒ∞ ---
        function renderTasks(tasks, dateStr) {
            const list = document.getElementById('task-list');
            list.innerHTML = '';

            tasks.forEach((task, index) => {
                const colorClass = getTaskColor(task.type);
                const li = document.createElement('li');
                li.className = `flex items-center bg-gray-50 p-3 rounded-xl border-l-4 ${colorClass} group`;
                li.innerHTML = `
                    <input type="checkbox" id="task-${index}" class="custom-checkbox w-5 h-5 text-indigo-600 rounded mr-3 cursor-pointer" 
                        ${task.done ? 'checked' : ''} onchange="toggleTask('${dateStr}', ${index})">
                    <label for="task-${index}" class="flex-1 font-medium text-gray-700 cursor-pointer select-none">
                        <span class="text-xs font-bold px-2 py-0.5 rounded bg-gray-200 text-gray-600 mr-2">${task.type}</span>
                        ${task.text}
                    </label>
                    <button onclick="deleteTask('${dateStr}', ${index})" class="text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition px-2">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                `;
                list.appendChild(li);
            });
        }

        function getTaskColor(type) {
            switch(type) {
                case 'Ders': return 'border-red-400';
                case 'Spor': return 'border-green-400';
                case '√áalƒ±≈üma': return 'border-blue-400';
                case 'Ya≈üam': return 'border-pink-400';
                default: return 'border-gray-400';
            }
        }

        function toggleTask(dateStr, index) {
            appData[dateStr].tasks[index].done = !appData[dateStr].tasks[index].done;
            saveData();
        }

        function deleteTask(dateStr, index) {
            if(confirm('G√∂revi silmek istiyor musun?')) {
                appData[dateStr].tasks.splice(index, 1);
                saveData();
            }
        }

        function addNewTask() {
            const text = document.getElementById('new-task-text').value;
            const type = document.getElementById('new-task-type').value;
            if(!text) return;

            const dateStr = formatDate(currentViewDate);
            getDailyData(dateStr).tasks.push({ text, type, done: false });
            
            document.getElementById('new-task-text').value = '';
            saveData();
        }

        // --- G√úN SE√áƒ∞Cƒ∞ ---
        function renderDaySelector() {
            const container = document.getElementById('day-selector');
            container.innerHTML = '';
            
            // Bug√ºn merkezli 7 g√ºn
            for (let i = -3; i <= 3; i++) {
                const d = new Date();
                d.setDate(d.getDate() + i);
                const dStr = formatDate(d);
                const isSelected = dStr === formatDate(currentViewDate);
                const isToday = dStr === formatDate(new Date());

                const btn = document.createElement('div');
                btn.className = `flex-shrink-0 w-14 h-16 rounded-xl flex flex-col items-center justify-center cursor-pointer transition ${isSelected ? 'bg-indigo-600 text-white shadow-lg scale-105' : 'bg-white text-gray-500 hover:bg-gray-100'}`;
                if(isToday && !isSelected) btn.classList.add('border-2', 'border-indigo-600');
                
                btn.innerHTML = `
                    <span class="text-xs font-bold">${getDayName(d).substring(0,3)}</span>
                    <span class="text-lg font-bold">${d.getDate()}</span>
                `;
                btn.onclick = () => { currentViewDate = d; updateUI(); };
                container.appendChild(btn);
            }
        }

        // --- Kƒ∞TAP & UYKU ---
        function saveReading() {
            const pages = parseInt(document.getElementById('reading-input').value);
            if(isNaN(pages) || pages < 0) return;
            
            const dateStr = formatDate(currentViewDate);
            getDailyData(dateStr).reading = (getDailyData(dateStr).reading || 0) + pages;
            saveData();
        }

        function saveSleep() {
            const val = parseFloat(document.getElementById('sleep-input').value);
            const dateStr = formatDate(currentViewDate);
            getDailyData(dateStr).sleep = val;
            saveData();
        }

        // --- SPOR MOD√úL√ú ---
        function loadExercises() {
            const group = document.getElementById('muscle-group').value;
            const select = document.getElementById('exercise-select');
            select.innerHTML = '';
            
            if(group && EXERCISE_DB[group]) {
                EXERCISE_DB[group].forEach(ex => {
                    const opt = document.createElement('option');
                    opt.value = ex;
                    opt.innerText = ex;
                    select.appendChild(opt);
                });
            } else {
                select.innerHTML = '<option>√ñnce B√∂lge Se√ßin</option>';
            }
        }

        function addWorkoutSet() {
            const muscle = document.getElementById('muscle-group').value;
            const exercise = document.getElementById('exercise-select').value;
            const weight = parseFloat(document.getElementById('w-weight').value) || 0;
            const sets = parseFloat(document.getElementById('w-sets').value) || 0;
            const reps = parseFloat(document.getElementById('w-reps').value) || 0;

            if(!exercise || sets === 0 || reps === 0) {
                alert('L√ºtfen hareket ve set/tekrar bilgilerini girin.');
                return;
            }

            // Volume Load Hesabƒ±
            const totalVol = weight > 0 ? (sets * reps * weight) : (sets * reps); // Aƒüƒ±rlƒ±ksƒ±zsa sadece tekrar sayƒ±sƒ±

            const dateStr = formatDate(currentViewDate);
            getDailyData(dateStr).workouts.push({ muscle, exercise, weight, sets, reps, totalVol });
            
            saveData();
            
            // Inputlarƒ± temizle
            document.getElementById('w-weight').value = '';
            document.getElementById('w-sets').value = '';
            document.getElementById('w-reps').value = '';
        }

        function renderWorkoutList(workouts) {
            const list = document.getElementById('workout-list');
            const totalVolEl = document.getElementById('total-volume');
            const volBar = document.getElementById('volume-bar');
            
            list.innerHTML = '';
            let dayTotalVol = 0;

            if(workouts.length === 0) {
                list.innerHTML = '<li class="text-gray-400 text-center italic text-xs py-2">Hen√ºz hareket girilmedi.</li>';
            } else {
                workouts.forEach((w, idx) => {
                    dayTotalVol += w.totalVol;
                    const li = document.createElement('li');
                    li.className = 'flex justify-between items-center bg-white p-2 rounded border border-gray-100';
                    li.innerHTML = `
                        <div>
                            <div class="font-bold text-gray-700">${w.exercise}</div>
                            <div class="text-xs text-gray-500">${w.sets} Set x ${w.reps} Tekrar @ ${w.weight}kg</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-green-600">${w.totalVol}</div>
                            <button onclick="deleteWorkout('${formatDate(currentViewDate)}', ${idx})" class="text-xs text-red-400"><i class="fa-solid fa-times"></i></button>
                        </div>
                    `;
                    list.appendChild(li);
                });
            }

            // Headerdaki Volume G√∂stergesi
            totalVolEl.innerText = dayTotalVol.toLocaleString();
            // Hedef olarak g√ºnl√ºk 10.000 volume load (tahmini) √ºzerinden bar doluluƒüu
            const percentage = Math.min((dayTotalVol / 10000) * 100, 100);
            volBar.style.width = `${percentage}%`;
        }

        function deleteWorkout(dateStr, index) {
            appData[dateStr].workouts.splice(index, 1);
            saveData();
        }

        // --- CHART.JS GRAFƒ∞ƒûƒ∞ (MIXED CHART: BAR & LINE) ---
        function renderWorkoutChart() {
            const canvas = document.getElementById('workoutChart');
            if(!canvas) return;
            const ctx = canvas.getContext('2d');
            
            // Chart.js bug fix: Canvas'ƒ± temizle ve mevcut chart'ƒ± yok et
            const existingChart = Chart.getChart(canvas);
            if (existingChart) {
                existingChart.destroy();
            }

            // Son 7 g√ºn√ºn verisini hazƒ±rla
            const labels = [];
            const dataVol = [];
            
            for(let i=6; i>=0; i--) {
                const d = new Date();
                d.setDate(d.getDate() - i);
                const dStr = formatDate(d);
                labels.push(getDayName(d).substring(0,3));
                
                const dayData = appData[dStr];
                let vol = 0;
                if(dayData && dayData.workouts) {
                    dayData.workouts.forEach(w => vol += w.totalVol);
                }
                dataVol.push(vol);
            }

            workoutChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Volume Load (Bar)',
                            data: dataVol,
                            backgroundColor: 'rgba(74, 222, 128, 0.5)',
                            borderColor: 'rgba(74, 222, 128, 1)',
                            borderWidth: 1,
                            order: 2
                        },
                        {
                            label: 'Trend (√áizgi)',
                            data: dataVol,
                            type: 'line',
                            borderColor: '#16a34a',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 3,
                            order: 1
                        }
                    ]
                },
                options: {
                    animation: false, // Stack overflow ve flicker'ƒ± √∂nlemek i√ßin
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true, grid: { display: false } },
                        x: { grid: { display: false } }
                    }
                }
            });
        }

        // --- SKORLAMA ---
        function calculateDailyScore(data) {
            let total = data.tasks.length;
            let done = data.tasks.filter(t => t.done).length;
            let score = total === 0 ? 0 : Math.round((done / total) * 100);
            
            document.getElementById('daily-score').innerText = score;
            
            let emoji = 'üò¥';
            if (score === 100) emoji = 'üèÜ';
            else if (score >= 80) emoji = 'üî•';
            else if (score >= 50) emoji = 'üëç';
            document.getElementById('daily-emoji').innerText = emoji;
        }

        // --- TAKVƒ∞M ---
        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            const label = document.getElementById('calendar-month');
            grid.innerHTML = '';
            
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const monthNames = ["Ocak", "≈ûubat", "Mart", "Nisan", "Mayƒ±s", "Haziran", "Temmuz", "Aƒüustos", "Eyl√ºl", "Ekim", "Kasƒ±m", "Aralƒ±k"];
            
            label.innerText = `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1).getDay(); // Pazar=0
            const offset = firstDay === 0 ? 6 : firstDay - 1; // Pzt=0 yap
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            for(let i=0; i<offset; i++) grid.innerHTML += '<div></div>';

            const todayStr = formatDate(new Date());

            for(let d=1; d<=daysInMonth; d++) {
                const dStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const hasData = appData[dStr];
                
                // Skor hesapla (varsa)
                let bgClass = 'bg-gray-100 text-gray-400';
                if(dStr === todayStr) bgClass = 'bg-indigo-600 text-white shadow-lg ring-2 ring-indigo-300';
                else if(hasData && hasData.tasks.length > 0) {
                    const done = hasData.tasks.filter(t => t.done).length;
                    const score = Math.round((done / hasData.tasks.length) * 100);
                    if(score === 100) bgClass = 'bg-green-500 text-white';
                    else if(score >= 50) bgClass = 'bg-yellow-400 text-white';
                    else bgClass = 'bg-red-300 text-white';
                }

                grid.innerHTML += `
                    <div class="calendar-day ${bgClass} rounded-lg flex items-center justify-center text-xs font-bold cursor-default relative" title="${dStr}">
                        ${d}
                        ${(hasData && hasData.workouts && hasData.workouts.length > 0) ? '<span class="absolute bottom-0.5 w-1 h-1 bg-blue-600 rounded-full"></span>' : ''}
                    </div>
                `;
            }
        }

        function changeMonth(dir) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + dir);
            renderCalendar();
        }

        // --- AYARLAR ---
        function openSettings() { document.getElementById('settings-modal').classList.remove('hidden'); }
        function closeSettings() { document.getElementById('settings-modal').classList.add('hidden'); }
        
        function setTheme(theme) {
            const header = document.getElementById('main-header');
            let grad = 'from-indigo-600 to-blue-500';
            
            if(theme === 'red') grad = 'from-red-600 to-orange-500';
            if(theme === 'emerald') grad = 'from-emerald-600 to-teal-500';
            if(theme === 'slate') grad = 'from-slate-800 to-gray-700';
            
            // Sƒ±nƒ±flarƒ± temizle ve yenisini ekle
            header.className = `relative bg-gradient-to-r ${grad} rounded-3xl p-6 text-white shadow-xl mb-8 transition-colors duration-500`;
            
            // Kaydet
            if(!appData.settings) appData.settings = {};
            appData.settings.theme = theme;
            saveData();
        }

        function applyTheme(theme) {
            setTheme(theme);
        }

        // Ba≈ülat
        window.onload = function() {
            updateUI();
        };

    </script>
</body>
</html>
